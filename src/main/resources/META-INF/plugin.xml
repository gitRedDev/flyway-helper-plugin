<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin require-restart="true">
    <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
    <id>com.helpers.flyway-helper</id>

    <!-- Public plugin name should be written in Title Case.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
    <name>Flyway-Helper</name>

    <description>
        Flyway helper plugin to help interacting with migrations.
        Avoid having migration version conflicts and get an "auto-calculated" version when creating a new one.
        The plugin goes even further and let you specify a remote branch to take into
        consideration while checking for version conflicts or/and when generating your
        "auto-calculated" next migration.
    </description>
    <vendor>red1</vendor>

    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>

    <extensions defaultExtensionNs="com.intellij">
        <notificationGroup id="flyway.migration.notification" displayType="BALLOON"/>
    </extensions>

    <actions>
        <action
                id="flyway.migration.refresh"
                class="com.helpers.flywayhelper.actions.RefreshMigrationAction"
                text="Refresh Migrations"
                icon="AllIcons.Actions.Refresh"
                description="Refresh migrations">
        </action>
        <group
                id="flyway.migration.settings"
                text="Flyway Helper"
                description="Flyway helper"
                icon="CustomIcons.PluginIcon"
                popup="true">
            <action
                    id="flyway.migration.configure.syncBranch"
                    class="com.helpers.flywayhelper.actions.ConfigureSyncBranchAction"
                    text="Configure Sync Branch"
                    icon="AllIcons.Ide.ConfigFile"
                    description="Configure sync branch">
            </action>
            <reference ref="flyway.migration.refresh" />
            <action
                    id="flyway.migration.readmore"
                    class="com.helpers.flywayhelper.actions.ReadMoreAction"
                    text="Read More..."
                    icon="AllIcons.Actions.More"
                    description="Read more...">
            </action>
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </group>
        <action
                id="flyway.migration.create"
                class="com.helpers.flywayhelper.actions.CreateMigrationAction"
                text="New Migration"
                icon="CustomIcons.Dark.MigrationFileIcon"
                description="New migration">
            <add-to-group group-id="NewGroup" anchor="after" relative-to-action="NewFile"/>
        </action>
        <action
                id="flyway.migration.markAsMigrationRootDirectory"
                class="com.helpers.flywayhelper.actions.MarkAsMigrationRootAction"
                text="Migrations Root"
                icon="CustomIcons.Dark.MigrationFolderRootIcon"
                description="Migrations root">
            <add-to-group group-id="MarkRootGroup" anchor="last"/>
        </action>
        <action
                id="flyway.migration.UnMarkAsMigrationRootAction"
                class="com.helpers.flywayhelper.actions.UnMarkAsMigrationRootAction"
                text="UnMark as Migrations Root"
                description="UnMark as Migrations root">
            <add-to-group group-id="MarkRootGroup" anchor="last"/>
        </action>
        <group
                id="flyway.migration.projectActions"
                text="Flyway Helper"
                description="Flyway helper"
                icon="CustomIcons.PluginIcon"
                popup="true">
            <reference ref="flyway.migration.refresh" />
            <add-to-group group-id="ProjectViewPopupMenu" anchor="before" relative-to-action="VersionControlsGroup"/>
        </group>
    </actions>

    <extensions defaultExtensionNs="com.intellij">
        <postStartupActivity implementation="com.helpers.flywayhelper.activities.OnOpenProjectActivity"/>
        <iconProvider implementation="com.helpers.flywayhelper.providers.MigrationRootIconProvider"/>
    </extensions>

    <change-notes>
        <![CDATA[
            <p><b>Version: 1.1.0</b></p>
            <ul>
              <li>Get the next version for your migration file automatically</li>
              <li>Avoid having version conflicts among your migration files</li>
            </ul>
            <p><i>PS: You can even sync it with a remote branch to get always the latest version that you may need</i></p>
            <p><b>Version: 1.2.0</b></p>
            <ul>
              <li>fix bugs</li>
              <li>add mark directory as migration root for specified folder to ensure compatibility with different specifications</li>
            </ul>
            <p><b>Version: 1.2.1</b></p>
            <ul>
              <li>Plugin is now compatible with intellij 2024.2</li>
            </ul>
            <p><b>Version: 1.2.2</b></p>
            <ul>
              <li>Fix some bugs within next migration version suggestions</li>
            </ul>
            <p><b>Version: 1.3.0</b></p>
            <ul>
              <li>Migration Root Folder and Sync Branch is now specified by project. (you can specify the configs for each project individually)</li>
            </ul>
            <p><b>Version: 1.3.1</b></p>
            <ul>
              <li>Update deprecated methods</li>
            </ul>
        ]]>
    </change-notes>

</idea-plugin>